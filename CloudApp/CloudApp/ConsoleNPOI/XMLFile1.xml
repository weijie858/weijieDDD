<?xml version="1.0" encoding="utf-8" ?>
<ImportConfig id="order">

  <!--本设计是讨论一种比较复杂的，包含表头表体的导入（如一张订单中可能包含多个商品的分录）。-->

  <!--Excel中的记录将被映射成的实体对象名（表头）-->

  <HeadClass>BusinessRule.Order</HeadClass>

  <!--表头中对表体实体引用的属性名。如果不是表头表体的结构，可以删除此结点-->

  <EntryProperty>OrderEntries</EntryProperty>

  <!--Excel中的记录将被映射成的实体对象名（表体）。如果不是表头表体的结构，可以删除此节点-->

  <EntryClass>BusinessRule.OrderEntry</EntryClass>

  <!--保存方法所在的类名-->

  <MethodClass>BusinessRule.OrderService</MethodClass>

  <!--对象构造完成之后调用的保存方法名-->

  <SaveMethod>Save</SaveMethod>

  <!--调用保存方法之前可能会有一些业务逻辑上的检查，此为检查的方法名，如果没有可以删除此节点-->

  <ExValidateMethod>ExValidate</ExValidateMethod>







  <!--以下为Excel中各列的信息配置-->

  <!--

  IsEntry:是否表体字段。默认为0，不是表体字段;

  IsPrimaryKey:是否唯一字段。因一个订单头可能对应多个订单体，即Excel中的多条记录对应一张订单。导入时将根据IsPrimaryKey=1的字段值来确定哪些行属于一张订单。

  Property:实体类中对应的属性名。

  ColumnName:Excel中对应的列头名。

  Requried:是否必录项。默认0，不必录。

  DataType:生成引入模板时将根据此生成对应列的有效性验证。如果是引用类型（DataType=ref），则会根据RefConfig生成下拉列表及保存时进行相应的转换（如将客户名称转换为客户ID，因为数据库中存的为ID，Excel中显示的为名称）。

  RefConfig:引用类型的配置信息。引用类型一般需要转换后保存，故配置项依次为 转换后的字段;转换时查找的表;转换时用到的比较字段;过滤条件。

  DefValue:默认值。支持多种默认值：$F{XXX}表示取系统级的变量，当然系统中要首先存在这些变量；$E{a.b}表示取其它对象的相关属性；$C{XXX}表示默认值为常量；$S{XXX}表示通过SQL取默认值等。

  Min:最小值。

  Max:最大值。

  MaxLen:最大长度。

  Comment:生成引入模板时列头的批注。

  -->

  <!--表头字段-->

  <Column IsPrimaryKey="1" Property="OrderNO" ColumnName="订单编号" Required="1" DataType="string" Comment="编号只能由字母或数字组成。" MaxLen="40"></Column>

  <Column Property="OrderDate" ColumnName="订单日期" Required="1" DataType="date" DefValue="$F{SysDate}" Comment="日期格式为YYYY-MM-DD，如果不录入则取系统当前日期。"></Column>

  <Column Property="CustomerID" ColumnName="客户名称" Required="1" DataType="ref" RefConfig="CustomerID;t_Customer;CustomerName;IsUsed=1"></Column>



  <!--表体字段-->

  <Column IsEntry="1" Property="InvID" ColumnName="商品名称" Required="1" DataType="ref" DefValue="InvID;t_Inventory;InvName;"></Column>

  <Column IsEntry="1" Property="Qty" ColumnName="数量" Required="1" DataType="decimal" ></Column>

  <Column IsEntry="1" Property="Price" ColumnName="单价" Required="1" DataType="decimal" DefValue="$E{InvID.StandardPrice}"></Column>

  <Column IsEntry="1" Property="Discount" ColumnName="折扣率(%)" DataType="decimal" Min="0" Max="100" DefValue="$C{0}" Comment="请输入0-100之前的数字。"></Column>



  <!--制单人不用在导入模板中显示，但数据库中要求有值，所以没有设置ColumnName属性，只设置了默认值-->

  <Column Property="CreateUser" DefValue="$F{UserNO}" ></Column>

</ImportConfig>
